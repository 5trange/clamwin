<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=windows-1252">
	<TITLE>ClamWin CD/USB - HowTo</TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 1.9.122  (Win32)">
	<META NAME="CREATED" CONTENT="20050531;10214200">
	<META NAME="CHANGEDBY" CONTENT="Russell Phillips">
	<META NAME="CHANGED" CONTENT="20050817;11443141">
	<STYLE>
	<!--
		@page { size: 8.27in 11.69in; margin-left: 0.79in; margin-right: 0.79in; margin-top: 0.79in; margin-bottom: 0.79in }
		P { color: #000000; font-family: "Arial", sans-serif; font-size: 12pt }
		H1 { color: #000000; text-align: center }
		H1.western { font-family: "Arial", sans-serif; font-size: 16pt }
		H2 { color: #000000 }
		H2.western { font-family: "Arial", sans-serif; font-size: 14pt; font-style: italic }
		PRE { color: #000000 }
	-->
	</STYLE>
</HEAD>
<BODY LANG="en-GB" TEXT="#000000" BGCOLOR="#ffffff" DIR="LTR">
<H1 CLASS="western"><FONT FACE="Arial, sans-serif"><FONT SIZE=5 STYLE="font-size: 16pt">Appendix
A</FONT></FONT></H1>
<H1 CLASS="western">How to Run ClamWin from CD or USB</H1>
<H2 CLASS="western">Introduction</H2>
<P>This tutorial explains how to create a CD or USB key with <A HREF="http://www.clamwin.com/">ClamWin</A>,
to allow a Windows PC to be scanned for viruses without having to
install ClamWin. Note that the CD/USB key is <I>not</I> bootable, and
so can only be used on a working Windows PC. This tutorial was
written to satisfy a feature request logged with the ClamWin project
(<A HREF="http://sourceforge.net/tracker/index.php?func=detail&amp;aid=945882&amp;group_id=105508&amp;atid=641465">RFE
945882</A>)</P>
<P>The PC that is used to create the CD/USB will need to have ClamWin
installed, and be able to copy files/folders to a CD or USB key.</P>
<H2 CLASS="western">Preparation</H2>
<P>Start by installing the latest version of ClamWin, and download
the latest virus definitions. See the ClamWin manual for full details
on how to do this. Note that, if you are going to create a CD, you
will not be able to update the virus definitions without creating a
new CD, since a CD is read-only.</P>
<H2 CLASS="western">Copy Folders</H2>
<P>Create a working folder in a convenient location to hold the files
that are to be copied onto CD/USB, eg <TT>C:\ClamWin-CD</TT><BR>In
the working folder, create a folder named <TT>ClamWin</TT>.<BR>Copy
the ClamWin program folder into <TT>C:\ClamWin-CD\ClamWin</TT>. By
default, the ClamWin program folder is installed to <TT>C:\Program
Files\ClamWin</TT><BR>Copy the ClamWin database folder into
<TT>C:\ClamWin-CD\ClamWin</TT>. In Windows 2000/XP, the ClamWin
database folder defaults to <TT>C:\Documents and
Settings\USERNAME\.clamwin\db</TT>, where <TT>USERNAME</TT> is your
login name (if it was installed for a single user) or <TT>C:\Documents
and Settings\All Users\.clamwin\db</TT> (if it was installed for all
users).</P>
<P>You should now have the following folders:</P>
<PRE>C:\ClamWin-CD
C:\ClamWin-CD\ClamWin\bin
C:\ClamWin-CD\ClamWin\db
C:\ClamWin-CD\ClamWin\lib</PRE><H2 CLASS="western">
Edit Config &amp; Create Auto-Run Files</H2>
<P>Open the file <TT>C:\ClamWin-CD\ClamWin\bin\ClamWin.conf</TT> in a
text editor, such as Windows Notepad. Edit it so that it looks like
the example below:</P>
<PRE>[ClamAV]
clamscan=clamscan.exe
freshclam=freshclam.exe
database=..\db
quarantinedir=
logfile=
[Updates]
dbupdatelogfile=..\freshclam.txt
time=</PRE><P>
In the <TT>C:\ClamWin-CD</TT> folder, create two text files, named
<TT>autorun.inf</TT> &amp; <TT>RUN_ME.vbs</TT>. Ensure that they do
not have a <TT>.txt</TT> extension.<BR>Edit <TT>autorun.inf</TT> and
edit it so that it only has the three lines below:</P>
<PRE>[autorun]
OPEN=RUN_ME.vbs
icon=ClamWin\bin\img\TrayIcon.ico</PRE><P>
Edit <TT>RUN_ME.vbs</TT> and edit it so that it only has the three
lines below:</P>
<PRE>set oShell = WScript.CreateObject (&quot;WScript.Shell&quot;)
oShell.Run &quot;ClamWin\bin\ClamWin.exe&quot;
set oShell = Nothing</PRE><H2 CLASS="western">
Copy Files to CD/USB</H2>
<P>Now you just need to copy the contents of <TT>C:\ClamWin-CD</TT>
to a CD or USB key. Do not copy the <TT>C:\ClamWin-CD</TT> folder
itself, only the contents. Exactly how this is done will depend on
whether a CD or USB key is to be used, and what software is to be
used.</P>
<H2 CLASS="western">Using the CD/USB</H2>
<P>To use it, insert the CD/USB into the PC to be scanned. If Windows
is set up correctly, ClamWin will automatically run. If it does not,
double-click on the <TT>RUN_ME.vbs</TT> file. If this does not work,
then the PC either does not have the Windows Script Host installed,
or it is disabled. In this case, you can manually run ClamWin by
double-clicking on the <TT>ClamWin.exe</TT> file in the <TT>ClamWin\bin</TT>
folder.</P>
<P>ClamWin should operate normally, but if run from CD or read-only
USB drive, it will have the following restrictions: 
</P>
<UL>
	<LI><P STYLE="margin-bottom: 0in">Files will not be quarantined</P>
	<LI><P STYLE="margin-bottom: 0in">Internet updates will not work</P>
	<LI><P>Preferences cannot be changed</P>
</UL>
<P>These restrictions will not apply if it is run from a USB drive
with read-write permissions.</P>
<P><BR><BR>
</P>
</BODY>
</HTML>